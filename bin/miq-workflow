#!/usr/bin/env ruby
# frozen_string_literal: true

require 'thor'
require_relative '../lib/bootstrap.rb'
require_relative '../lib/cli/cli.rb'

at_exit do
  # Do cleanup
  GitFlow.tear_down()
  
  # Exception or normal exit?
  if $!
    #$logger.nil? ? warn($!.to_s) : $logger.error($!.to_s)
    # Find the correct ExitCode 
    exit($!.class::EXIT_CODE) if $!.kind_of?(GitFlow::Error)
    exit 1
  end
end

GitFlow::Cli::MainCli.start()
